{"version":3,"file":"index.js","sources":["../src/RoughContext.ts","../node_modules/use-deep-compare-effect/dist/use-deep-compare-effect.esm.js","../src/RoughComponents.tsx","../node_modules/dequal/dist/dequal.mjs","../src/index.tsx"],"sourcesContent":["import React, { MutableRefObject } from 'react';\nimport { Config } from 'roughjs/bin/core';\n\ntype SvgRef = MutableRefObject<SVGSVGElement>;\ntype CanvasRef = MutableRefObject<HTMLCanvasElement>;\n\ninterface RoughContextProps {\n\tref?: SvgRef | CanvasRef;\n\tconfig?: Config;\n\twidth?: number;\n\ttype: 'canvas' | 'svg';\n\theight?: number;\n}\n\nconst RoughContext = React.createContext<RoughContextProps>({\n\twidth: 300,\n\theight: 150,\n\ttype: 'canvas'\n});\n\nRoughContext.displayName = 'RoughContext';\n\nexport default RoughContext;\n","import React from 'react';\nimport deepEqual from 'dequal';\n\nfunction checkDeps(deps) {\n  if (!deps || !deps.length) {\n    throw new Error('useDeepCompareEffect should not be used with no dependencies. Use React.useEffect instead.');\n  }\n\n  if (deps.every(isPrimitive)) {\n    throw new Error('useDeepCompareEffect should not be used with dependencies that are all primitive values. Use React.useEffect instead.');\n  }\n}\n\nfunction isPrimitive(val) {\n  return val == null || /^[sbn]/.test(typeof val);\n}\n\nfunction useDeepCompareMemoize(value) {\n  var ref = React.useRef();\n\n  if (!deepEqual(value, ref.current)) {\n    ref.current = value;\n  }\n\n  return ref.current;\n}\n\nfunction useDeepCompareEffect(callback, dependencies) {\n  if (process.env.NODE_ENV !== 'production') {\n    checkDeps(dependencies);\n  }\n\n  React.useEffect(callback, useDeepCompareMemoize(dependencies));\n}\n\nfunction useDeepCompareEffectNoCheck(callback, dependencies) {\n  React.useEffect(callback, useDeepCompareMemoize(dependencies));\n}\n\nexport default useDeepCompareEffect;\nexport { useDeepCompareEffectNoCheck };\n","import useDeepCompareEffect from 'use-deep-compare-effect';\nimport React, { useContext, FC, memo } from 'react';\nimport { RoughSVG } from 'roughjs/bin/svg';\nimport { Drawable } from 'roughjs/bin/core';\nimport { RoughCanvas } from 'roughjs/bin/canvas';\nexport { Point } from 'roughjs/bin/geometry';\nimport * as Props from './RoughComponentProps';\nimport RoughContext from './RoughContext';\n\ntype RoughRenderer = RoughSVG | RoughCanvas;\ntype RoughOutput = Node | Drawable;\n\ninterface RendererProps {\n\trender: (rc: RoughRenderer) => RoughOutput;\n}\n\nconst Renderer: FC<RendererProps> = ({ render }) => {\n\tconst { ref, config, width, height, type } = useContext(RoughContext);\n\n\tconst clearCanvas = (): void => {\n\t\tif (!(width && height)) {\n\t\t\tthrow new Error('Canvas should have a defined width and height');\n\t\t}\n\t\tconst canvas = ref && (ref.current as HTMLCanvasElement);\n\t\tconst ctx = canvas && canvas.getContext('2d');\n\t\tctx && ctx.clearRect(0, 0, width, height);\n\t};\n\n\tuseDeepCompareEffect(() => {\n\t\tconst rendererElement = ref && ref.current;\n\n\t\tif (!rendererElement) return;\n\n\t\tif (type === 'svg') {\n\t\t\tconst roughSvg = new RoughSVG(rendererElement as SVGSVGElement, config);\n\t\t\tconst node = render(roughSvg) as Node;\n\t\t\trendererElement.appendChild(node);\n\n\t\t\treturn (): void => {\n\t\t\t\trendererElement.removeChild(node);\n\t\t\t};\n\t\t} else {\n\t\t\tconst roughCanvas = new RoughCanvas(\n\t\t\t\trendererElement as HTMLCanvasElement,\n\t\t\t\tconfig\n\t\t\t);\n\t\t\trender(roughCanvas);\n\t\t}\n\t}, [ref, config, render, type]);\n\n\tif (type === 'canvas') clearCanvas();\n\treturn null;\n};\n\nexport const Line: FC<Props.LineProps> = memo(\n\t({ x1, y1, x2, y2, ...props }) => {\n\t\tconst renderProps = React.useCallback(\n\t\t\t(rc: RoughRenderer) => rc.line(x1, y1, x2, y2, props),\n\t\t\t[x1, y1, x2, y2, props]\n\t\t);\n\n\t\treturn (\n\t\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t\t);\n\t}\n);\nLine.displayName = 'Line';\n\nexport const Rectangle: FC<Props.RectangleProps> = memo(\n\t({ x, y, width, height, ...props }) => {\n\t\tconst renderProps = React.useCallback(\n\t\t\t(rc: RoughRenderer) => rc.rectangle(x, y, width, height, props),\n\t\t\t[x, y, width, height, props]\n\t\t);\n\n\t\treturn (\n\t\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t\t);\n\t}\n);\nRectangle.displayName = 'Rectangle';\n\nexport const Ellipse: FC<Props.EllipseProps> = memo(\n\t({ x, y, width, height, ...props }) => {\n\t\tconst renderProps = React.useCallback(\n\t\t\t(rc: RoughRenderer) => rc.ellipse(x, y, width, height, props),\n\t\t\t[x, y, width, height, props]\n\t\t);\n\n\t\treturn (\n\t\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t\t);\n\t}\n);\nEllipse.displayName = 'Ellipse';\n\nexport const Circle: FC<Props.CircleProps> = memo(\n\t({ x, y, diameter, ...props }) => {\n\t\tconst renderProps = React.useCallback(\n\t\t\t(rc: RoughRenderer) => rc.circle(x, y, diameter, props),\n\t\t\t[x, y, diameter, props]\n\t\t);\n\n\t\treturn (\n\t\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t\t);\n\t}\n);\nCircle.displayName = 'Circle';\n\nexport const LinearPath: FC<Props.LinearPathProps> = memo(\n\t({ points, ...props }) => {\n\t\tconst renderProps = React.useCallback(\n\t\t\t(rc: RoughRenderer) => rc.linearPath(points, props),\n\t\t\t[points, props]\n\t\t);\n\n\t\treturn (\n\t\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t\t);\n\t}\n);\nLinearPath.displayName = 'LinearPath';\n\nexport const Polygon: FC<Props.PolygonProps> = memo(({ points, ...props }) => {\n\tconst renderProps = React.useCallback(\n\t\t(rc: RoughRenderer) => rc.polygon(points, props),\n\t\t[points, props]\n\t);\n\n\treturn (\n\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t);\n});\nPolygon.displayName = 'Polygon';\n\nexport const Arc: FC<Props.ArcProps> = memo(\n\t({ x, y, width, height, start, stop, closed, ...props }) => {\n\t\tconst renderProps = React.useCallback(\n\t\t\t(rc: RoughRenderer) =>\n\t\t\t\trc.arc(x, y, width, height, start, stop, closed, props),\n\t\t\t[x, y, width, height, start, stop, closed, props]\n\t\t);\n\n\t\treturn (\n\t\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t\t);\n\t}\n);\nArc.displayName = 'Arc';\n\nexport const Curve: FC<Props.CurveProps> = memo(({ points, ...props }) => {\n\tconst renderProps = React.useCallback(\n\t\t(rc: RoughRenderer) => rc.curve(points, props),\n\t\t[points, props]\n\t);\n\n\treturn (\n\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t);\n});\nCurve.displayName = 'Curve';\n\nexport const Path: FC<Props.PathProps> = memo(({ d, ...props }) => {\n\tconst renderProps = React.useCallback(\n\t\t(rc: RoughRenderer) => rc.path(d, props),\n\t\t[d, props]\n\t);\n\n\treturn (\n\t\t<Renderer render={(rc: RoughRenderer): RoughOutput => renderProps(rc)} />\n\t);\n});\nPath.displayName = 'Path';\n","export default function dequal(foo, bar) {\n\tvar ctor, len;\n\tif (foo === bar) return true;\n\tif (foo && bar && (ctor=foo.constructor) === bar.constructor) {\n\t\tif (ctor === Date) return foo.getTime() === bar.getTime();\n\t\tif (ctor === RegExp) return foo.toString() === bar.toString();\n\t\tif (ctor === Array && (len=foo.length) === bar.length) {\n\t\t\twhile (len-- && dequal(foo[len], bar[len]));\n\t\t\treturn len === -1;\n\t\t}\n\t\tif (ctor === Object) {\n\t\t\tif (Object.keys(foo).length !== Object.keys(bar).length) return false;\n\t\t\tfor (len in foo) if (!(len in bar) || !dequal(foo[len], bar[len])) return false;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn foo !== foo && bar !== bar;\n}\n","import React, { FC, MutableRefObject, RefObject } from 'react';\nimport { Config } from 'roughjs/bin/core';\nimport RoughContext from './RoughContext';\n\ntype SvgRef = MutableRefObject<SVGSVGElement>;\ntype CanvasRef = MutableRefObject<HTMLCanvasElement>;\ntype renderer = 'canvas' | 'svg';\n\ninterface RoughProps {\n\twidth?: number;\n\theight?: number;\n\tconfig?: Config;\n\trenderer?: renderer;\n}\n\ninterface RoughCompProps extends RoughProps {\n\tforwardedRef?: RefObject<unknown>;\n}\n\nexport const ReactRoughComp: FC<RoughCompProps> = ({\n\tconfig,\n\twidth = 300,\n\theight = 150,\n\trenderer = 'canvas',\n\tforwardedRef,\n\tchildren\n}) => {\n\tconst svgRef = React.useRef<SVGSVGElement>();\n\tconst canvasRef = React.useRef<HTMLCanvasElement>();\n\n\tif (forwardedRef) {\n\t\treturn (\n\t\t\t<RoughContext.Provider\n\t\t\t\tvalue={{\n\t\t\t\t\tconfig,\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t\ttype: 'canvas',\n\t\t\t\t\tref: forwardedRef as SvgRef\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</RoughContext.Provider>\n\t\t);\n\t}\n\n\tif (renderer === 'svg') {\n\t\treturn (\n\t\t\t<RoughContext.Provider\n\t\t\t\tvalue={{\n\t\t\t\t\tconfig,\n\t\t\t\t\ttype: 'svg',\n\t\t\t\t\tref: svgRef as SvgRef\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg width={width} height={height} ref={svgRef as SvgRef}>\n\t\t\t\t\t{children}\n\t\t\t\t</svg>\n\t\t\t</RoughContext.Provider>\n\t\t);\n\t}\n\n\treturn (\n\t\t<RoughContext.Provider\n\t\t\tvalue={{\n\t\t\t\tconfig,\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t\ttype: 'canvas',\n\t\t\t\tref: canvasRef as CanvasRef\n\t\t\t}}\n\t\t>\n\t\t\t<canvas width={width} height={height} ref={canvasRef as CanvasRef}>\n\t\t\t\t{children}\n\t\t\t</canvas>\n\t\t</RoughContext.Provider>\n\t);\n};\n\nexport const ReactRough: React.FC<RoughCompProps> = React.forwardRef(\n\t(props, ref) => {\n\t\treturn (\n\t\t\t<ReactRoughComp {...props} forwardedRef={ref as RefObject<unknown>} />\n\t\t);\n\t}\n);\n\nReactRough.displayName = 'ReactRough';\n\nexport * from './RoughComponents';\nexport default ReactRough;\n"],"names":["RoughContext","React","createContext","width","height","type","isPrimitive","val","test","displayName","Renderer","render","useContext","ref","config","callback","dependencies","value","process","env","NODE_ENV","deps","length","Error","every","checkDeps","useEffect","dequal","foo","bar","ctor","len","constructor","Date","getTime","RegExp","toString","Array","Object","keys","deepEqual","useRef","current","useDeepCompareEffect","rendererElement","roughSvg","RoughSVG","node","appendChild","removeChild","roughCanvas","RoughCanvas","canvas","ctx","getContext","clearRect","clearCanvas","Line","memo","x1","y1","x2","y2","props","renderProps","useCallback","rc","line","Rectangle","x","y","rectangle","Ellipse","ellipse","Circle","diameter","circle","LinearPath","points","linearPath","Polygon","polygon","Arc","start","stop","closed","arc","Curve","curve","Path","d","path","ReactRoughComp","renderer","forwardedRef","children","svgRef","canvasRef","Provider","ReactRough","forwardRef"],"mappings":"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"}